# （一）计算机网络体系结构

本章思维导图：
![ch01](https://z3.ax1x.com/2021/04/17/ch40bT.png)

## 1. 概念&功能

### 1.1 计算机网络概念

**计算机网络**: 是一个将分散的、具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现 **资源共享** 和 **信息传递** 的系统。

计算机网络是互连的、自治的计算机集合。  
- **互连**-通过通信链路互联互通
- **自治**-无主从关系


### 1.2 计算机网络的功能

计算机网络的两个重要功能：
1. 资源共享 
2. 信息传递
3. 分布式处理    
    - 多台计算机处理一个任务的不同部分
    - 提高可靠性
    - 复杂均衡

### 1.3 计算机网络的发展

#### 第一阶段

- ARPANET（阿帕网）
- interconnected network（互联网）
- Internet（因特网）
**网络** 把许多计算机连接在一起,而 **互联网** 则把许多网络连接在一起，**因特网** 是世界上最大的互联网。

#### 第二阶段

三级结构：主干网-地区网-校园网

#### 第三阶段

多层次 ISP 结构

**ISP**: 因特网服务提供者/因特网服务提供商，是一个向广大用户综合提供互联网接入业务、信息业务、和增值业务的公司，如中国电信、中国联动、中国移动等。分为主干ISP、地区ISP和本地ISP。

主机A→本地ISP→地区ISP→主干ISP→地区ISP→本地ISP→主机B


## 2. 组成与分类

### 2.1 计算机网络的组成

1. **组成部分**：硬件、软件、协议（一系列规则和约定的集合)

2. 工作方式：
    - 边缘部分：用户直接使用
        - C/S方式（Client/Server）
        - P2P方式（peer-tp-peer）
    - 核心部分: 为边缘部分服务

3. 功能组成
    - 通信子网：实现数据通信
    - 资源子网：实现资源共享/数据处理

### 2.2 计算机网络的分类

1. 按分布范围分
    - 广域网 WAN
    - 城域网 MAN
    - 局域网 LAN
    - 个人区域网 PAN
2. 按使用者分
    - 公用网
    - 专用网
3. 按交换技术分
    - 电路交换
    - 报文交换
    - 分组交换
4. 按拓扑结构分
    - 总线型
    - 星型
    - 环型
    - 网状型
5. 按传输技术分
    - 广播式网络：共享公共通信信道
    - 点对点网络：使用分组存储转发和路由选择机制

## 3. 标准化工作及相关组织

### 3.1 标准化工作

1. 标准的分类
    - 法定标准由权威机构制定的正式的、合法的标准：OSI
    - 事实标准某些公司的产品在竞争中占据了主流，时间长了，这些产品中的协议和技术就成了标准：TCP/IP
2. **RFC (Request For Comments)** ———因特网标准的形式
    RFC要上升为因特网正式标准的四个阶段:  
    1. 因特网草案( Internet Draft）这个阶段还不是RFC文档。  
    2. 建议标准（Proposed Standard）从这个阶段开始成为RFC文档。
    3. 草案标准（Draft Standard，如今已取消)
    4. 因特网标准( Internet Standard)

### 3.2 标准化工作相关组织

- 国际标准化组织 ISO：OsI模型、HDLC协议
- 国际电信联盟 ITU：制定通信规则
- 电气和电子工程师协会 IEEE：学术机构、IEEE802 系列标准、5G
- lnternet工程任务组 IETF：负责因特网相关标准的制定 RFC XXXX

## 4. 性能指标

- 速率
- 带宽
- 吞吐量
- 时延
- 时延带宽积
- 往返时间RTT

### 4.1 速率

速率即 **数据率** 或称 **数据传输率** 或 **比特率**。

比特：`1/0` 位。

连接在计算机网络上的主机在数字信道上传送数据 **位数的速率**。

单位是 b/s，kb/s，Mb/s，Gb/s，Tb/s

存储容量：1Byte（字节）=8bit（比特）

### 4.2 带宽

1. “**带宽**” 原本指某个信号具有的频带宽度，即最高频率与最低频率之差，单位是赫兹(Hz)。
2. 计算机网络中，**带宽** 用来表示网络的通信线路传送数据的能力，通常是指单位时间内从网络中的某一点到另一点所能通过的“ **最高数据率** ”。单位是“比特每秒”，b/s，kb/s，Mb/s，Gb/s。
**网络设备所支持的最高速度**

电磁波传播速率为 `2x10^8` m/s，
电磁波1us可向前传播200m。

链路带宽=1Mb/s，
主机在1us内可向链路发1bit数据。

### 4.3 吞吐量

表示在 **单位时间** 内通过 **某个网络（或信道、接口）** 的数据量。单位b/s，kb/s，Mb/s等。 

**吞吐量** 受网络的带宽或网络的额定速率的限制。

> 区别：速率是指实际上的速率，带宽指理论上最高速率，吞吐量指所有信道加在一起的速率。

### 4.4 时延

指数据（报文/分组/比特流）从网络（或链路）的一端传送到另一端所需的时间。也叫延迟或迟延。单位是s。

**时延** = 发送时延 + 传播时延 + 排队时延 + 处理时延

1. 发送时延  
    发生在主机内部。
    公式：发送时延 = $\frac{数据长度}{信道带宽}$  
    <font color=red>高速链路原理</font>：提高发送速率，缩短发送时延。而不是改变传播时延。
2. 传播时延
    取决于电磁波传播速度（2x10^8m/s）和链路长度。  
    公式：传播时延 = $\frac{信道长度}{电磁波在信道上的传播速率}$
3. 排队时延  
    等待输出/输入链路可用的时间。
4. 处理时延  
    检错，找出口的时间。

### 4.5 时延带宽积

公式：时延带宽积（bit） = 传播时延（s） x 带宽（b/s）

图解：时延带宽积又称为以比特为单位的链路长度。

![时延带宽积](https://z3.ax1x.com/2021/04/15/cReFkF.png)

### 4.6 往返时延 RTT

**从发送方发送数据开始，到发送方收到接收方的确认** （接收方收到数据后立即发送确认),总共经历的时延。

RTT越大，在收到确认之前，可以发送的数据越多。

RTT包括：
- 往返传播时延 = 传播时延 * 2
- 末端处理时间（接收方）

### 4.7 利用率

分为 **信道利用率** 和 **网络利用率**。

1. 信道利用率 = 有数据通过时间 / （有+无）数据通过
时间
2. 网络利用率：信道利用率加权平均值

**信道利用率越大，时延越大。**

## 5. 分层结构

### 5.1 为什么需要分层

发送文件前要完成的工作:

1. 发起通信的计算机必须将数据通信的通路进行激活。  
2. 要告诉网络如何识别目的主机。  
3. 发起通信的计算机要查明目的主机是否开机，并且与网络连接正常。  
4. 发起通信的计算机要弄清楚，对方计算机中文件管理程序是否已经做好准备工作。  
5. 确保差错和意外可以解决。
6. ...

### 5.2 如何分层

分层结构：协议、服务、接口

1. 实体: 第n层中的活动元素称为 **n层实体**。同一层的实体叫 **对等实体**。  
2. 协议:为进行网络中的 **对等实体** 数据交换而建立的规则、标准或约定称为网络协议。【**水平**】
    协议的三大要素
    - 语法：规定传输数据的格式
    - 语义：规定要完成的功能
    - 同步：规定各种操作的顺序
3. 接口：上层使用下层服务的入口
4. 服务：下层为相邻上层提供的服务

## 6. 概念总结

- 网络体系结构是从 **功能** 上描述计算机网络结构。
- 计算机网络体系结构简称网络体系结构是 **分层结构**。
- 每层遵循某个/些 **网络协议** 以完成本层功能。
- **计算机网络体系结构** 是计算机网络的 **各层及其协议** 的集合。
- 第n层在向n+1层提供服务时，此服务不仅包含第n层本身的功能，还包含由下层服务提供的功能。
- 仅仅在 **相邻层间有接口**，且所提供服务的具体实现细节对上一层完全屏蔽。
- 体系结构是 **抽象** 的，而实现是指能运行的一些软件和硬件。

## 7. OSI 参考模型

### 7.1 计算机网路分层结构

![计算机网路分层结构](https://z3.ax1x.com/2021/04/16/chP8Y9.png)

### 7.2 ISO/OSI 怎么来的？

为了解决计算机网络复杂的大问题 -> 分层结构（按功能)

目的: 支持 **异构网络** 系统的互联互通。
**国际标准化组织（ISO）** 于1984年提出 **开放系统互连（OSI）** 参考模型。

OSI 参考模型很具有学习价值，但是在市场上是失败的！

### 7.3 OSI 七层参考模型

![OSI 参考模型](https://z3.ax1x.com/2021/04/16/chiDBT.png)

### 7.4 OSI 参考模型解释通信过程

注意区分 **端到端** 与 **点到点** 的过程。

![](https://z3.ax1x.com/2021/04/16/cheUdP.png)

数据的传输过程：

![](https://z3.ax1x.com/2021/04/16/chmg6H.png)

### 7.5 应用层

应用层：用户与网络的界面，所有能和用户交互产生网络流量的程序。
 
典型应用层服务：  
- 文件传输（FTP）  
- 电子邮件（SMTP）  
- 万维网（HTTP）  

### 7.6 表示层

处理在两个通信系统中交换信息的表示方式（语法和语义）

- 功能一：数据格式交换（翻译官）  
- 功能二：数据加密解密
- 功能三：数据压缩喝恢复

### 7.7 会话层

向表示层实体/用户进程提供 **建立连接** 并在连接上 **有序地传输数据**。  

这是会话，也是 **建立同步** （SYB）。  

- 功能一：建立、管理、终止会话  
- 功能二：使用校验点可使会话在通信失效时从校验点/同步点继续恢复通信，实现数据同步。  
    适用于传输大文件。

### 7.8 传输层

负责主机中 **两个进程** 的通信，即 **端到端** 的通信。传输单位是报文段或用户数据报。

- 功能一: 可靠传输、不可靠传输  
- 功能二: 差错控制  
- 功能三: 流量控制  
- 功能四: 复用分用  

### 7.9 网络层

主要任务是把 **分组** 从源端传到目的端，为分组交换网上的不同主机提供通信服务。  
网络层传输单位是 **数据报**。

- 功能一: 路由选择最佳路径  
- 功能二: 流量控制  
- 功能三: 差错控制  
- 功能四: 拥塞控制  
    若所有结点都来不及接受分组,而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施,缓解这种拥塞。

### 7.10 数据链路层

主要任务是把网络层传下来的数据报 **组装成帧**。数据链路层/链路层的传输单位是 **帧**。

功能一：成帧（定义帧的开始和结束）...1000001010101010...  
功能二：差错控制 **帧错+位错**
功能三：流量控制
功能四：访问（接入）控制 控制对信道的访问

### 7.11 物理层

主要任务是在 **物理媒体** 上实现 **比特流** 的 **透明传输**。

**透明传输**: 指不管所传数据是什么样的比特组合,都应当能够在链路上传送。

- 功能一: 定义接口特性  
- 功能二: 定义传输模式（单工、半双工、双工）  
- 功能三: 定义传输速率  
- 功能四: 比特同步  
- 功能五: 比特编码  

主要协议：Rj45、802.3

## 8. TCP/IP 参考模型

### 8.1 OSI参考模型与TCP/IP参考模型

OSI 参考模型是专家提出的理想模型，没有实践。给后续参考模型提供了参考意义。

TCP/IP 是先有实践，最后总结的参考模型。

TCP/IP 协议栈出现在 TCP/IP参考模型前，提供理论基础。

![](https://z3.ax1x.com/2021/04/17/chRjNd.png)

### 8.2 OSI参考模型与TCP/IP参考模型相同点

1. 都分层
2. 基于独立的协议栈的概念
3. 都可以实现异构网络互联

### 8.2 OSI参考模型与TCP/IP参考模型不同点

> 关于 osi参考模型与TCP/IP参考模型不同点的对比是考点。

1. OSI定义三点:服务、协议、接口  
2. OSI先出现，参考模型先于协议发明，不偏向特定协议  
3. TCP/IP设计之初就考虑到异构网互联问题，将IP
作为 **重要层次**
4. 如下所示

||ISO/OSI参考模型|TCP/IP模型|
|-|-|-|
|网络层|无连接+面向连接|无连接|
|传输层|面向连接|无连接+面向连接|

> **面向连接** 分为三个阶段，第一是建立连接，在此阶段，发出一个建立连接的请求。只有在连接成功建立之后，才能开始数据传输，这是第二阶段。接着，当数据传输完毕，必须释放连接。
> 而 **面向无连** 接没有这么多阶段，它直接进行数据传输。

##  9. 五层参考模型

### 9.1 分层结构

5层参考模型结合了OSI和TCP/IP的优点，是我们需要学习的参考模型。

- 借鉴了OSI的优点：各层的功能规定的很清晰。  
- 综合了TCP/IP的优点：分层简单。

![](https://z3.ax1x.com/2021/04/17/chfdWn.png)

### 9.2 五层参考模型数据封装与解封装

![](https://z3.ax1x.com/2021/04/17/chf5y6.png)
